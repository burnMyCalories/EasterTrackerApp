<!DOCTYPE html>
<html>

<head>
	<title>Add Map</title>

	<link rel="stylesheet" href="styles/common.css">
	<link rel="stylesheet" href="styles/map.css">

</head>

<body>
	<div id="map"></div>
</body>
<script
	src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAwb-FjgOhpZrFDOn18WkrJ5IQKhG2zbLo&callback=initMap&libraries=&v=weekly"
	defer></script>
<script>
	let mapStyle = [
		{
			"featureType": "all",
			"elementType": "all",
			"stylers": [
				{
					"visibility": "on"
				}
			]
		},
		{
			"featureType": "all",
			"elementType": "labels",
			"stylers": [
				{
					"visibility": "off"
				},
				{
					"saturation": "-100"
				}
			]
		},
		{
			"featureType": "all",
			"elementType": "labels.text.fill",
			"stylers": [
				{
					"saturation": 36
				},
				{
					"color": "#000000"
				},
				{
					"lightness": 40
				},
				{
					"visibility": "off"
				}
			]
		},
		{
			"featureType": "all",
			"elementType": "labels.text.stroke",
			"stylers": [
				{
					"visibility": "off"
				},
				{
					"color": "#000000"
				},
				{
					"lightness": 16
				}
			]
		},
		{
			"featureType": "all",
			"elementType": "labels.icon",
			"stylers": [
				{
					"visibility": "off"
				}
			]
		},
		{
			"featureType": "administrative",
			"elementType": "geometry.fill",
			"stylers": [
				{
					"color": "#000000"
				},
				{
					"lightness": 20
				}
			]
		},
		{
			"featureType": "administrative",
			"elementType": "geometry.stroke",
			"stylers": [
				{
					"color": "#000000"
				},
				{
					"lightness": 17
				},
				{
					"weight": 1.2
				}
			]
		},
		{
			"featureType": "landscape",
			"elementType": "geometry",
			"stylers": [
				{
					"color": "#000000"
				},
				{
					"lightness": 20
				}
			]
		},
		{
			"featureType": "landscape",
			"elementType": "geometry.fill",
			"stylers": [
				{
					"color": "#4d6059"
				}
			]
		},
		{
			"featureType": "landscape",
			"elementType": "geometry.stroke",
			"stylers": [
				{
					"color": "#4d6059"
				}
			]
		},
		{
			"featureType": "landscape.natural",
			"elementType": "geometry.fill",
			"stylers": [
				{
					"color": "#4d6059"
				}
			]
		},
		{
			"featureType": "poi",
			"elementType": "geometry",
			"stylers": [
				{
					"lightness": 21
				}
			]
		},
		{
			"featureType": "poi",
			"elementType": "geometry.fill",
			"stylers": [
				{
					"color": "#4d6059"
				}
			]
		},
		{
			"featureType": "poi",
			"elementType": "geometry.stroke",
			"stylers": [
				{
					"color": "#4d6059"
				}
			]
		},
		{
			"featureType": "road",
			"elementType": "geometry",
			"stylers": [
				{
					"visibility": "on"
				},
				{
					"color": "#7f8d89"
				}
			]
		},
		{
			"featureType": "road",
			"elementType": "geometry.fill",
			"stylers": [
				{
					"color": "#7f8d89"
				}
			]
		},
		{
			"featureType": "road.highway",
			"elementType": "geometry.fill",
			"stylers": [
				{
					"color": "#7f8d89"
				},
				{
					"lightness": 17
				}
			]
		},
		{
			"featureType": "road.highway",
			"elementType": "geometry.stroke",
			"stylers": [
				{
					"color": "#7f8d89"
				},
				{
					"lightness": 29
				},
				{
					"weight": 0.2
				}
			]
		},
		{
			"featureType": "road.arterial",
			"elementType": "geometry",
			"stylers": [
				{
					"color": "#000000"
				},
				{
					"lightness": 18
				}
			]
		},
		{
			"featureType": "road.arterial",
			"elementType": "geometry.fill",
			"stylers": [
				{
					"color": "#7f8d89"
				}
			]
		},
		{
			"featureType": "road.arterial",
			"elementType": "geometry.stroke",
			"stylers": [
				{
					"color": "#7f8d89"
				}
			]
		},
		{
			"featureType": "road.local",
			"elementType": "geometry",
			"stylers": [
				{
					"color": "#000000"
				},
				{
					"lightness": 16
				}
			]
		},
		{
			"featureType": "road.local",
			"elementType": "geometry.fill",
			"stylers": [
				{
					"color": "#7f8d89"
				}
			]
		},
		{
			"featureType": "road.local",
			"elementType": "geometry.stroke",
			"stylers": [
				{
					"color": "#7f8d89"
				}
			]
		},
		{
			"featureType": "transit",
			"elementType": "geometry",
			"stylers": [
				{
					"color": "#000000"
				},
				{
					"lightness": 19
				}
			]
		},
		{
			"featureType": "water",
			"elementType": "all",
			"stylers": [
				{
					"color": "#2b3638"
				},
				{
					"visibility": "on"
				}
			]
		},
		{
			"featureType": "water",
			"elementType": "geometry",
			"stylers": [
				{
					"color": "#2b3638"
				},
				{
					"lightness": 17
				}
			]
		},
		{
			"featureType": "water",
			"elementType": "geometry.fill",
			"stylers": [
				{
					"color": "#24282b"
				}
			]
		},
		{
			"featureType": "water",
			"elementType": "geometry.stroke",
			"stylers": [
				{
					"color": "#24282b"
				}
			]
		},
		{
			"featureType": "water",
			"elementType": "labels",
			"stylers": [
				{
					"visibility": "off"
				}
			]
		},
		{
			"featureType": "water",
			"elementType": "labels.text",
			"stylers": [
				{
					"visibility": "off"
				}
			]
		},
		{
			"featureType": "water",
			"elementType": "labels.text.fill",
			"stylers": [
				{
					"visibility": "off"
				}
			]
		},
		{
			"featureType": "water",
			"elementType": "labels.text.stroke",
			"stylers": [
				{
					"visibility": "off"
				}
			]
		},
		{
			"featureType": "water",
			"elementType": "labels.icon",
			"stylers": [
				{
					"visibility": "off"
				}
			]
		}
	];

	function initMap() {

		const styledMapType = new google.maps.StyledMapType(mapStyle);
		const map = new google.maps.Map(document.getElementById("map"), {
			zoom: 15,
			mapTypeControlOptions: {
				mapTypeIds: [
					"roadmap",
					"satellite",
					"styled_map"
				]
			}
		});

		map.mapTypes.set("styled_map", styledMapType);
		map.setMapTypeId("styled_map");

		let myPosition;
		let myPosttionMarker;

		if (navigator.geolocation) {
			navigator.geolocation.getCurrentPosition(
				(position) => {
					myPosition = {
						lat: position.coords.latitude,
						lng: position.coords.longitude,
					};
					map.setCenter(myPosition);
					myPosttionMarker = new google.maps.Marker({
						position: myPosition,
						map: map,
					});

					// randEggs(5, myPosition);
					for (let i = 0; i < 5; i++) {
						let fpos = fakeRandPos(myPosition)
						eggTestMarker = new google.maps.Marker({
							position: fpos,
							map: map,
							icon: `./images/map/egg-${Math.ceil(Math.random() * 3)}.svg`
						});
					}
				}
			);
		}



	}

	function randEggs(num, source) {
		for (let i = 0; i < num; i++) {
			let egg = {
				position: fakeRandPos(source),
				map, map,
				icon: `./images/map/egg-${Math.ceil(Math.random() * 3)}.svg`
			}
			let marker = new google.maps.Marker({ egg });
		}
	}

	function fakeRandPos(source) {
		let lat = source.lat;
		let lng = source.lng;
		let fakePos = { lat: lat + (Math.random() - 0.5) / 100, lng: lng + (Math.random() - 0.5) / 100 };
		console.log(source, fakePos)
		return fakePos;
	}
</script>

</html>