# 后端接口

## 注册登录相关

1.  注册

    url:`/register`

    方法：POST

    参数：

    ```
    username：用户名
    password：密码
    gender：性别
    nickname：昵称
    contact：联系方式（email/手机）
    latitude：纬度
    longitude：精度
    ```

    返回：

    -   状态码：

        ```
        400：参数不对
        410：注册失败
        201：注册成功
        ```

    -   结果：

        ```
        status：状态{
        	code：标识码（0表示成功，非0表示失败）
        	msg：具体状态
        }
        result：数据{
        	data：具体数据
        	rows：受影响的行数
        }
        ```

    -   example:

        `POST http://localhost:8080/test/register?gender=M&is_online=1&username=test2222&password=111111&latitude=15&longitude=45&nickname=abcd&contact=13800000000`

        ```json
        {
            "status": {
                "code": 0,
                "msg": "Success"
            },
            "result": {
                "data": [
                    {
                        "id": 1277068326,
                        "username": "test2222",
                        "gender": "M",
                        "nickname": "abcd",
                        "contact": "13800000000",
                        "is_online": 0,
                        "latitude": 15.0,
                        "longitude": 45.0,
                        "set_count": 0,
                        "get_count": 0,
                        "is_deleted": 0
                    }
                ],
                "rows": 1
            }
        }
        ```

2.  登录

    url：`/login`

    方法：PUT

    参数：

    ```
    username：用户名
    password：密码
    ```

    返回：

    -   状态码

        ```
        400：参数不对
        401：登录失败
        403：该账号已经登录
        200：登录成功
        ```

    -   结果：

        ```
        status：状态{
        	code：标识码（0表示成功，非0表示失败）
        	msg：具体状态
        }
        result：数据{
        	data：具体数据
        	rows：受影响的行数
        }
        ```

    -   example

        `PUT http://localhost:8080/test/login?username=test2222&password=111111`

        ```json
        {
            "status": {
                "code": 0,
                "msg": "Success"
            },
            "result": {
                "data": [
                    {
                        "id": 629114150,
                        "username": "test2222",
                        "gender": "M",
                        "nickname": "abcd",
                        "contact": "13800000000",
                        "is_online": 1,
                        "latitude": 15.0,
                        "longitude": 45.0,
                        "set_count": 0,
                        "get_count": 0,
                        "is_deleted": 0
                    }
                ],
                "rows": 1
            }
        }
        ```

3.  登出

    url：`/logout`

    方法：PUT

    参数：

    ```
    username：用户名
    ```

    返回：

    -   状态码

        ```
        400：参数不对
        401：登出失败
        403：该账号已经登出
        200：登出成功
        ```

    -   结果：

        ```
        status：状态{
        	code：标识码（0表示成功，非0表示失败）
        	msg：具体状态
        }
        result：数据{
        	data：具体数据
        	rows：受影响的行数
        }
        ```

    -   example

        `PUT http://localhost:8080/test/logout?username=test2222`

        ```json
        {
            "status": {
                "code": 0,
                "msg": "Success"
            },
            "result": {
                "data": [
                    {
                        "id": 629114150,
                        "username": "test2222",
                        "gender": "M",
                        "nickname": "abcd",
                        "contact": "13800000000",
                        "is_online": 0,
                        "latitude": 15.0,
                        "longitude": 45.0,
                        "set_count": 0,
                        "get_count": 0,
                        "is_deleted": 0
                    }
                ],
                "rows": 1
            }
        }
        ```

4.  验证

    url：`/confirm`

    方法：POST

    参数：

    ```
    email：邮箱
    mobile：手机号
    （二选一）
    ```

    返回：

    -   状态码

        ```
        400：参数不对
        201：验证码发送成功
        500：验证码发送失败
        ```

    -   结果：

        ```
        status：状态{
        	code：标识码（0表示成功，非0表示失败）
        	msg：具体状态
        }
        code：验证码
        expire：失效时间
        ```

    -   example

        `POST http://localhost:8080/test/confirm?email=543777820@qq.com`

        ```json
        {
            "code": "5sc5ty",
            "expire": "2020-10-28 16:37:02",
            "status": {
                "code": 0,
                "msg": "Success"
            }
        }
        ```

        ```json
        {
            "code": "l1e32z",
            "expire": "2020-10-28 16:38:50",
            "status": {
                "code": 0,
                "data": "发送成功"（如果发送短信这儿是中文，目前无解）
            }
        }
        ```

-   注意：

    除上述操作之外的所有操作都必须先登录，否则会返回401状态，表示未登录：（超时也会401，10分钟内没有其他操作会自动登出）

    ```json
    {
        "status": {
            "code": 1,
            "msg": "Not Logged In"
        },
        "result": {}
    }
    ```

## 用户信息相关

1.  查询用户

    url：`/user`

    方法：GET

    参数：

    ```
    uuname：当前操作的用户名（必需）
    id：用户id
    username：用户名
    password：密码
    gender：性别
    nickname：昵称
    contact：联系方式（email/手机）
    latitude：纬度
    longitude：精度
    除必需外其余参数均可选，uuname可与username不一致
    ```

    返回：

    -   状态码

        ```
        400：参数不对
        410：没查到
        200：查询成功
        ```

    -   结果

        ```
        status：状态{
        	code：标识码（0表示成功，非0表示失败）
        	msg：具体状态
        }
        result：数据{
        	data：具体数据
        	rows：受影响的行数
        }
        ```

    -   example

        `GET http://localhost:8080/test/user?username=abc&uuname=test2222`

        ```json
        {
            "status": {
                "code": 0,
                "msg": "Success"
            },
            "result": {
                "data": [
                    {
                        "id": 1814538945,
                        "username": "abc",
                        "gender": "M",
                        "nickname": "abcdefg",
                        "contact": "13801111100",
                        "is_online": 0,
                        "latitude": 22.0,
                        "longitude": 77.0,
                        "set_count": 0,（埋彩蛋数量）
                        "get_count": 0,（挖彩蛋数量）
                        "is_deleted": 0（是否已删除）
                    }
                ],
                "rows": 1
            }
        }
        ```

2.  添加用户

    url：`/user`

    方法：POST

    参数：

    ```
    uuname：当前操作的用户名
    username：用户名
    password：密码
    gender：性别
    nickname：昵称
    contact：联系方式（email/手机）
    latitude：纬度
    longitude：精度
    均为必需项
    ```

    返回：

    -   状态码

        ```
        400：参数不对
        410：添加失败
        201：添加成功
        ```

    -   结果

        ```
        status：状态{
        	code：标识码（0表示成功，非0表示失败）
        	msg：具体状态
        }
        result：数据{
        	data：具体数据
        	rows：受影响的行数
        }
        ```

    -   example

        `POST http://localhost:8080/test/user?gender=M&is_online=1&password=123456&latitude=15&longitude=45&nickname=abcd&contact=13800000000&username=test1111&uuname=test2222`

        ```json
        {
            "status": {
                "code": 0,
                "msg": "Success"
            },
            "result": {
                "data": [
                    {
                        "id": 1039101465,
                        "username": "test1111",
                        "gender": "M",
                        "nickname": "abcd",
                        "contact": "13800000000",
                        "is_online": 0,
                        "latitude": 15.0,
                        "longitude": 45.0,
                        "set_count": 0,
                        "get_count": 0,
                        "is_deleted": 0
                    }
                ],
                "rows": 1
            }
        }
        ```

3.  修改用户

    url：`/user`

    方法：PUT

    参数：

    ```
    uuname：当前操作的用户名
    id：用户id
    username：用户名
    password：密码
    gender：性别
    nickname：昵称
    contact：联系方式（email/手机）
    latitude：纬度
    longitude：精度
    is_online：是否在线
    is_deleted：是否已删除
    uuname为必需，username、id、nickname三选一，其余非必需
    ```

    返回：

    -   状态码

        ```
        400：参数不对
        410：修改失败
        201：修改成功
        ```

    -   结果

        ```
        status：状态{
        	code：标识码（0表示成功，非0表示失败）
        	msg：具体状态
        }
        result：数据{
        	data：具体数据
        	rows：受影响的行数
        }
        ```

    -   example

        `PUT http://localhost:8080/test/user?username=test1111&password=123456&uuname=test2222`

        ```json
        {
            "status": {
                "code": 0,
                "msg": "Success"
            },
            "result": {
                "data": [
                    {
                        "id": 1039101465,
                        "username": "test1111",
                        "gender": "M",
                        "nickname": "abcd",
                        "contact": "13800000000",
                        "is_online": 0,
                        "latitude": 15.0,
                        "longitude": 45.0,
                        "set_count": 0,
                        "get_count": 0,
                        "is_deleted": 0
                    }
                ],
                "rows": 1
            }
        }
        ```

4.  删除用户

    url：`/user`

    方法：DELETE

    参数：

    ```
    uuname：当前操作的用户名
    id：用户id
    username：用户名
    nickname：昵称
    uuname为必需，username、id、nickname三选一
    ```

    返回：

    -   状态码

        ```
        400：参数不对
        410：删除失败
        201：删除成功
        ```

    -   结果

        ```
        status：状态{
        	code：标识码（0表示成功，非0表示失败）
        	msg：具体状态
        }
        result：数据{
        	data：具体数据
        	rows：受影响的行数
        }
        ```

    -   example

        `DELETE http://localhost:8080/test/user?username=test1111&uuname=test2222`

        ```json
        {
            "status": {
                "code": 0,
                "msg": "Success"
            },
            "result": {
                "data": [
                    {
                        "id": 1039101465,
                        "username": "test1111",
                        "gender": "M",
                        "nickname": "abcd",
                        "contact": "13800000000",
                        "is_online": 0,
                        "latitude": 15.0,
                        "longitude": 45.0,
                        "set_count": 0,
                        "get_count": 0,
                        "is_deleted": 0
                    }
                ],
                "rows": 1
            }
        }
        ```

## 好友相关

注意：好友是单向的，如想双向加好友可发送两次请求

1.  查询好友

    url：`/friendship`

    方法：GET

    参数：

    ```
    uuname：当前操作的用户名（必需）
    id：好友id
    userfrom_id：from的用户id
    userto_id：to的用户id
    userfrom_username：from的用户名
    userto_username：to的用户名
    userfrom_nickname：from的昵称
    userto_nickname：to的昵称
    除必需外其余参数均可选
    ```

    返回：

    -   状态码

        ```
        400：参数不对
        410：没查到
        200：查询成功
        ```

    -   结果

        ```
        status：状态{
        	code：标识码（0表示成功，非0表示失败）
        	msg：具体状态
        }
        result：数据{
        	data：具体数据
        	rows：受影响的行数
        }
        ```

    -   example

        `GET http://localhost:8080/test/friendship?userto_nickname=abcdefg&uuname=test2222`

        ```json
        {
            "status": {
                "code": 0,
                "msg": "Success"
            },
            "result": {
                "data": [
                    {
                        "id": 1927044041,
                        "userfrom": {（from的用户）
                            "id": 1139780601,
                            "username": "test4",
                            "gender": "M",
                            "nickname": "abcdefg",
                            "contact": "13801111100",
                            "is_online": 1,
                            "latitude": 21.0,
                            "longitude": 55.0,
                            "set_count": 1,
                            "get_count": 0,
                            "is_deleted": 0
                        },
                        "userto": {（to的用户）
                            "id": 687005410,
                            "username": "test2",
                            "gender": "M",
                            "nickname": "abcdefg",
                            "contact": "13801111100",
                            "is_online": 0,
                            "latitude": 14.0,
                            "longitude": 66.0,
                            "set_count": 1,
                            "get_count": 1,
                            "is_deleted": 0
                        },
                        "is_deleted": 0
                    },
                    {
                        "id": 2014164941,
                        "userfrom": {
                            "id": 1139780601,
                            "username": "test4",
                            "gender": "M",
                            "nickname": "abcdefg",
                            "contact": "13801111100",
                            "is_online": 1,
                            "latitude": 21.0,
                            "longitude": 55.0,
                            "set_count": 1,
                            "get_count": 0,
                            "is_deleted": 0
                        },
                        "userto": {
                            "id": 1325542530,
                            "username": "test3",
                            "gender": "M",
                            "nickname": "abcdefg",
                            "contact": "13801111100",
                            "is_online": 0,
                            "latitude": 21.0,
                            "longitude": 55.0,
                            "set_count": 0,
                            "get_count": 2,
                            "is_deleted": 0
                        },
                        "is_deleted": 1
                    }
                ],
                "rows": 2
            }
        }
        ```

2.  添加好友

    url：`/friendship`

    方法：POST

    参数：

    ```
    uuname：当前操作的用户名
    userfrom_id：from的用户id
    userto_id：to的用户id
    均为必需项
    ```

    返回：

    -   状态码

        ```
        400：参数不对
        410：添加失败
        201：添加成功
        ```

    -   结果

        ```
        status：状态{
        	code：标识码（0表示成功，非0表示失败）
        	msg：具体状态
        }
        result：数据{
        	data：具体数据
        	rows：受影响的行数
        }
        ```

    -   example

        `POST http://localhost:8080/test/friendship?userfrom_id=1139780601&userto_id=687005410&uuname=test2222`

        ```json
        {
            "status": {
                "code": 0,
                "msg": "Success"
            },
            "result": {
                "data": [
                    {
                        "id": 1385729779,
                        "userfrom": {
                            "id": 1139780601,
                            "username": "test4",
                            "gender": "M",
                            "nickname": "abcdefg",
                            "contact": "13801111100",
                            "is_online": 1,
                            "latitude": 21.0,
                            "longitude": 55.0,
                            "set_count": 1,
                            "get_count": 0,
                            "is_deleted": 0
                        },
                        "userto": {
                            "id": 687005410,
                            "username": "test2",
                            "gender": "M",
                            "nickname": "abcdefg",
                            "contact": "13801111100",
                            "is_online": 0,
                            "latitude": 14.0,
                            "longitude": 66.0,
                            "set_count": 1,
                            "get_count": 1,
                            "is_deleted": 0
                        },
                        "is_deleted": 0
                    }
                ],
                "rows": 1
            }
        }
        ```

3.  修改好友

    url：`/friendship`

    方法：PUT

    参数：

    ```
    uuname：当前操作的用户名
    id：好友id
    userfrom_id：from的用户id
    userto_id：to的用户id
    is_deleted：是否已删除
    uuname为必需，id或userfrom_id和userto_id必需
    ```

    返回：

    -   状态码

        ```
        400：参数不对
        410：修改失败
        201：修改成功
        ```

    -   结果

        ```
        status：状态{
        	code：标识码（0表示成功，非0表示失败）
        	msg：具体状态
        }
        result：数据{
        	data：具体数据
        	rows：受影响的行数
        }
        ```

    -   example

        `PUT http://localhost:8080/test/friendship?is_deleted=0&userfrom_id=1139780601&userto_id=687005410&uuname=test2222`

        ```json
        {
            "status": {
                "code": 0,
                "msg": "Success"
            },
            "result": {
                "data": [
                    {
                        "id": 1927044041,
                        "userfrom": {
                            "id": 1139780601,
                            "username": "test4",
                            "gender": "M",
                            "nickname": "abcdefg",
                            "contact": "13801111100",
                            "is_online": 1,
                            "latitude": 21.0,
                            "longitude": 55.0,
                            "set_count": 1,
                            "get_count": 0,
                            "is_deleted": 0
                        },
                        "userto": {
                            "id": 687005410,
                            "username": "test2",
                            "gender": "M",
                            "nickname": "abcdefg",
                            "contact": "13801111100",
                            "is_online": 0,
                            "latitude": 14.0,
                            "longitude": 66.0,
                            "set_count": 1,
                            "get_count": 1,
                            "is_deleted": 0
                        },
                        "is_deleted": 0
                    }
                ],
                "rows": 1
            }
        }
        ```

4.  删除好友

    url：`/friendship`

    方法：DELETE

    参数：

    ```
    uuname：当前操作的用户名
    id：好友id
    userfrom_id：from的用户id
    userto_id：to的用户id
    uuname为必需，id或userfrom_id和userto_id必需
    ```

    返回：

    -   状态码

        ```
        400：参数不对
        410：删除失败
        201：删除成功
        ```

    -   结果

        ```
        status：状态{
        	code：标识码（0表示成功，非0表示失败）
        	msg：具体状态
        }
        result：数据{
        	data：具体数据
        	rows：受影响的行数
        }
        ```

    -   example

        `DELETE http://localhost:8080/test/friendship?uuname=test2222&id=1385729779`

        ```json
        {
            "status": {
                "code": 0,
                "msg": "Success"
            },
            "result": {
                "data": [
                    {
                        "id": 1385729779,
                        "userfrom": {
                            "id": 1139780601,
                            "username": "test4",
                            "gender": "M",
                            "nickname": "abcdefg",
                            "contact": "13801111100",
                            "is_online": 1,
                            "latitude": 21.0,
                            "longitude": 55.0,
                            "set_count": 1,
                            "get_count": 0,
                            "is_deleted": 0
                        },
                        "userto": {
                            "id": 687005410,
                            "username": "test2",
                            "gender": "M",
                            "nickname": "abcdefg",
                            "contact": "13801111100",
                            "is_online": 0,
                            "latitude": 14.0,
                            "longitude": 66.0,
                            "set_count": 1,
                            "get_count": 1,
                            "is_deleted": 0
                        },
                        "is_deleted": 0
                    }
                ],
                "rows": 1
            }
        }
        ```

## 消息相关

1.  查询消息

    url：`/message`

    方法：GET

    参数：

    ```
    uuname：当前操作的用户名（必需）
    id：消息id
    friend_id：好友id
    userfrom_id：from的用户id
    userto_id：to的用户id
    userfrom_username：from的用户名
    userto_username：to的用户名
    userfrom_nickname：from的昵称
    userto_nickname：to的昵称
    除必需外其余参数均可选
    ```

    返回：

    -   状态码

        ```
        400：参数不对
        410：没查到
        200：查询成功
        ```

    -   结果

        ```
        status：状态{
        	code：标识码（0表示成功，非0表示失败）
        	msg：具体状态
        }
        result：数据{
        	data：具体数据
        	rows：受影响的行数
        }
        ```

    -   example

        `GET http://localhost:8080/test/message?userto_nickname=abcdefg&uuname=test2222`

        ```json
        {
            "status": {
                "code": 0,
                "msg": "Success"
            },
            "result": {
                "data": [
                    {
                        "id": 52551251,
                        "friend": {（好友关系）
                            "id": 1927044041,
                            "userfrom": {
                                "id": 1139780601,
                                "username": "test4",
                                "gender": "M",
                                "nickname": "abcdefg",
                                "contact": "13801111100",
                                "is_online": 1,
                                "latitude": 21.0,
                                "longitude": 55.0,
                                "set_count": 1,
                                "get_count": 0,
                                "is_deleted": 0
                            },
                            "userto": {
                                "id": 687005410,
                                "username": "test2",
                                "gender": "M",
                                "nickname": "abcdefg",
                                "contact": "13801111100",
                                "is_online": 0,
                                "latitude": 14.0,
                                "longitude": 66.0,
                                "set_count": 1,
                                "get_count": 1,
                                "is_deleted": 0
                            },
                            "is_deleted": 0
                        },
                        "type": 1,（消息类型）
                        "content": "ddddddddddddddddd",（消息内容）
                        "is_deleted": 0（是否已删除）
                    },
                    {
                        "id": 464859269,
                        "friend": {
                            "id": 2014164941,
                            "userfrom": {
                                "id": 1139780601,
                                "username": "test4",
                                "gender": "M",
                                "nickname": "abcdefg",
                                "contact": "13801111100",
                                "is_online": 1,
                                "latitude": 21.0,
                                "longitude": 55.0,
                                "set_count": 1,
                                "get_count": 0,
                                "is_deleted": 0
                            },
                            "userto": {
                                "id": 1325542530,
                                "username": "test3",
                                "gender": "M",
                                "nickname": "abcdefg",
                                "contact": "13801111100",
                                "is_online": 0,
                                "latitude": 21.0,
                                "longitude": 55.0,
                                "set_count": 0,
                                "get_count": 2,
                                "is_deleted": 0
                            },
                            "is_deleted": 1
                        },
                        "type": 1,
                        "content": "abcabcabcabcdddddddd",
                        "is_deleted": 0
                    },
                    {
                        "id": 922674365,
                        "friend": {
                            "id": 2014164941,
                            "userfrom": {
                                "id": 1139780601,
                                "username": "test4",
                                "gender": "M",
                                "nickname": "abcdefg",
                                "contact": "13801111100",
                                "is_online": 1,
                                "latitude": 21.0,
                                "longitude": 55.0,
                                "set_count": 1,
                                "get_count": 0,
                                "is_deleted": 0
                            },
                            "userto": {
                                "id": 1325542530,
                                "username": "test3",
                                "gender": "M",
                                "nickname": "abcdefg",
                                "contact": "13801111100",
                                "is_online": 0,
                                "latitude": 21.0,
                                "longitude": 55.0,
                                "set_count": 0,
                                "get_count": 2,
                                "is_deleted": 0
                            },
                            "is_deleted": 1
                        },
                        "type": 1,
                        "content": "abcabcabcabc",
                        "is_deleted": 0
                    },
                    {
                        "id": 938847569,
                        "friend": {
                            "id": 1927044041,
                            "userfrom": {
                                "id": 1139780601,
                                "username": "test4",
                                "gender": "M",
                                "nickname": "abcdefg",
                                "contact": "13801111100",
                                "is_online": 1,
                                "latitude": 21.0,
                                "longitude": 55.0,
                                "set_count": 1,
                                "get_count": 0,
                                "is_deleted": 0
                            },
                            "userto": {
                                "id": 687005410,
                                "username": "test2",
                                "gender": "M",
                                "nickname": "abcdefg",
                                "contact": "13801111100",
                                "is_online": 0,
                                "latitude": 14.0,
                                "longitude": 66.0,
                                "set_count": 1,
                                "get_count": 1,
                                "is_deleted": 0
                            },
                            "is_deleted": 0
                        },
                        "type": 1,
                        "content": "ttttttttttttt",
                        "is_deleted": 0
                    },
                    {
                        "id": 998369285,
                        "friend": {
                            "id": 1927044041,
                            "userfrom": {
                                "id": 1139780601,
                                "username": "test4",
                                "gender": "M",
                                "nickname": "abcdefg",
                                "contact": "13801111100",
                                "is_online": 1,
                                "latitude": 21.0,
                                "longitude": 55.0,
                                "set_count": 1,
                                "get_count": 0,
                                "is_deleted": 0
                            },
                            "userto": {
                                "id": 687005410,
                                "username": "test2",
                                "gender": "M",
                                "nickname": "abcdefg",
                                "contact": "13801111100",
                                "is_online": 0,
                                "latitude": 14.0,
                                "longitude": 66.0,
                                "set_count": 1,
                                "get_count": 1,
                                "is_deleted": 0
                            },
                            "is_deleted": 0
                        },
                        "type": 1,
                        "content": "abcabcabcabc",
                        "is_deleted": 0
                    },
                    {
                        "id": 1279150339,
                        "friend": {
                            "id": 1927044041,
                            "userfrom": {
                                "id": 1139780601,
                                "username": "test4",
                                "gender": "M",
                                "nickname": "abcdefg",
                                "contact": "13801111100",
                                "is_online": 1,
                                "latitude": 21.0,
                                "longitude": 55.0,
                                "set_count": 1,
                                "get_count": 0,
                                "is_deleted": 0
                            },
                            "userto": {
                                "id": 687005410,
                                "username": "test2",
                                "gender": "M",
                                "nickname": "abcdefg",
                                "contact": "13801111100",
                                "is_online": 0,
                                "latitude": 14.0,
                                "longitude": 66.0,
                                "set_count": 1,
                                "get_count": 1,
                                "is_deleted": 0
                            },
                            "is_deleted": 0
                        },
                        "type": 1,
                        "content": "dddddddddd",
                        "is_deleted": 0
                    },
                    {
                        "id": 1741805756,
                        "friend": {
                            "id": 1927044041,
                            "userfrom": {
                                "id": 1139780601,
                                "username": "test4",
                                "gender": "M",
                                "nickname": "abcdefg",
                                "contact": "13801111100",
                                "is_online": 1,
                                "latitude": 21.0,
                                "longitude": 55.0,
                                "set_count": 1,
                                "get_count": 0,
                                "is_deleted": 0
                            },
                            "userto": {
                                "id": 687005410,
                                "username": "test2",
                                "gender": "M",
                                "nickname": "abcdefg",
                                "contact": "13801111100",
                                "is_online": 0,
                                "latitude": 14.0,
                                "longitude": 66.0,
                                "set_count": 1,
                                "get_count": 1,
                                "is_deleted": 0
                            },
                            "is_deleted": 0
                        },
                        "type": 1,
                        "content": "uuuuuuu",
                        "is_deleted": 0
                    }
                ],
                "rows": 7
            }
        }
        ```

2.  添加消息

    url：`/message`

    方法：POST

    参数：

    ```
    uuname：当前操作的用户名
    friend_id：好友id
    type：消息类别（1：文字，2：语音，3：图片，4：视频）
    content：消息内容（文字内容或uri）
    均为必需项
    ```

    返回：

    -   状态码

        ```
        400：参数不对
        410：添加失败
        201：添加成功
        ```

    -   结果

        ```
        status：状态{
        	code：标识码（0表示成功，非0表示失败）
        	msg：具体状态
        }
        result：数据{
        	data：具体数据
        	rows：受影响的行数
        }
        ```

    -   example

        `POST http://localhost:8080/test/message?type=2&friend_id=1927044041&uuname=test2222&content=uri://123123`

        ```json
        {
            "status": {
                "code": 0,
                "msg": "Success"
            },
            "result": {
                "data": [
                    {
                        "id": 208172447,
                        "friend": {
                            "id": 1927044041,
                            "userfrom": {
                                "id": 1139780601,
                                "username": "test4",
                                "gender": "M",
                                "nickname": "abcdefg",
                                "contact": "13801111100",
                                "is_online": 1,
                                "latitude": 21.0,
                                "longitude": 55.0,
                                "set_count": 1,
                                "get_count": 0,
                                "is_deleted": 0
                            },
                            "userto": {
                                "id": 687005410,
                                "username": "test2",
                                "gender": "M",
                                "nickname": "abcdefg",
                                "contact": "13801111100",
                                "is_online": 0,
                                "latitude": 14.0,
                                "longitude": 66.0,
                                "set_count": 1,
                                "get_count": 1,
                                "is_deleted": 0
                            },
                            "is_deleted": 0
                        },
                        "type": 2,
                        "content": "uri://123123",
                        "is_deleted": 0
                    }
                ],
                "rows": 1
            }
        }
        ```

3.  修改消息

    url：`/message`

    方法：PUT

    参数：

    ```
    uuname：当前操作的用户名
    id：消息id
    friend_id：好友id
    is_deleted：是否已删除
    uuname为必需，id或friend_id必需
    ```

    返回：

    -   状态码

        ```
        400：参数不对
        410：修改失败
        201：修改成功
        ```

    -   结果

        ```
        status：状态{
        	code：标识码（0表示成功，非0表示失败）
        	msg：具体状态
        }
        result：数据{
        	data：具体数据
        	rows：受影响的行数
        }
        ```

    -   example

        `PUT http://localhost:8080/test/message?friend_id=1927044041&uuname=test2222&is_deleted=0`

        ```json
        {
            "status": {
                "code": 0,
                "msg": "Success"
            },
            "result": {
                "data": [
                    {
                        "id": 1741805756,
                        "friend": {
                            "id": 1927044041,
                            "userfrom": {
                                "id": 1139780601,
                                "username": "test4",
                                "gender": "M",
                                "nickname": "abcdefg",
                                "contact": "13801111100",
                                "is_online": 1,
                                "latitude": 21.0,
                                "longitude": 55.0,
                                "set_count": 1,
                                "get_count": 0,
                                "is_deleted": 0
                            },
                            "userto": {
                                "id": 687005410,
                                "username": "test2",
                                "gender": "M",
                                "nickname": "abcdefg",
                                "contact": "13801111100",
                                "is_online": 0,
                                "latitude": 14.0,
                                "longitude": 66.0,
                                "set_count": 1,
                                "get_count": 1,
                                "is_deleted": 0
                            },
                            "is_deleted": 0
                        },
                        "type": 1,
                        "content": "uuuuuuu",
                        "is_deleted": 0
                    }
                ],
                "rows": 1
            }
        }
        ```

4.  删除消息

    url：`/message`

    方法：DELETE

    参数：

    ```
    uuname：当前操作的用户名
    id：消息id
    friend_id：好友id
    uuname为必需，id或friend_id必需
    ```

    返回：

    -   状态码

        ```
        400：参数不对
        410：删除失败
        201：删除成功
        ```

    -   结果

        ```
        status：状态{
        	code：标识码（0表示成功，非0表示失败）
        	msg：具体状态
        }
        result：数据{
        	data：具体数据
        	rows：受影响的行数
        }
        ```

    -   example

        `DELETE http://localhost:8080/test/message?id=208172447&uuname=test2222`

        ```json
        {
            "status": {
                "code": 0,
                "msg": "Success"
            },
            "result": {
                "data": [
                    {
                        "id": 208172447,
                        "friend": {
                            "id": 1927044041,
                            "userfrom": {
                                "id": 1139780601,
                                "username": "test4",
                                "gender": "M",
                                "nickname": "abcdefg",
                                "contact": "13801111100",
                                "is_online": 1,
                                "latitude": 21.0,
                                "longitude": 55.0,
                                "set_count": 1,
                                "get_count": 0,
                                "is_deleted": 0
                            },
                            "userto": {
                                "id": 687005410,
                                "username": "test2",
                                "gender": "M",
                                "nickname": "abcdefg",
                                "contact": "13801111100",
                                "is_online": 0,
                                "latitude": 14.0,
                                "longitude": 66.0,
                                "set_count": 1,
                                "get_count": 1,
                                "is_deleted": 0
                            },
                            "is_deleted": 0
                        },
                        "type": 2,
                        "content": "uri://123123",
                        "is_deleted": 0
                    }
                ],
                "rows": 1
            }
        }
        ```

## 彩蛋相关

注意：此时的CRUD只是对彩蛋数据，并没有进行埋彩蛋、挖彩蛋的操作

1.  查询彩蛋

    url：`/egg`

    方法：GET

    参数：

    ```
    uuname：当前操作的用户名（必需）
    id：彩蛋id
    name：彩蛋名称
    color：彩蛋颜色（可以传个RGB16进制的那种）
    type：彩蛋类型（1：文字，2：语音，3：图片，4：视频）
    latitude：纬度
    longitude：精度
    除必需外其余参数均可选
    ```

    返回：

    -   状态码

        ```
        400：参数不对
        410：没查到
        200：查询成功
        ```

    -   结果

        ```
        status：状态{
        	code：标识码（0表示成功，非0表示失败）
        	msg：具体状态
        }
        result：数据{
        	data：具体数据
        	rows：受影响的行数
        }
        ```

    -   example

        `GET http://localhost:8080/test/egg?uuname=test2222`

        ```json
        {
            "status": {
                "code": 0,
                "msg": "Success"
            },
            "result": {
                "data": [
                    {
                        "id": 1942732372,
                        "name": "egg11",
                        "color": "blue",
                        "type": 2,
                        "latitude": 21.0000001,
                        "longitude": 55.0,
                        "content": "url://something2111",
                        "expire_time": "2021-01-01 00:00:00.0",
                        "is_deleted": 0
                    },
                    {
                        "id": 2076294926,
                        "name": "egg15",
                        "color": "yellow",
                        "type": 3,
                        "latitude": 21.0,
                        "longitude": 66.0,
                        "content": "url://something2333",
                        "expire_time": "2020-11-01 01:00:00.0",
                        "is_deleted": 0
                    }
                ],
                "rows": 2
            }
        }
        ```

2.  添加彩蛋

    url：`/egg`

    方法：POST

    参数：

    ```
    uuname：当前操作的用户名（必需）
    name：彩蛋名称
    color：彩蛋颜色（可以传个RGB16进制的那种）
    type：彩蛋类型（1：文字，2：语音，3：图片，4：视频）
    latitude：纬度
    longitude：精度
    content：彩蛋内容
    expire_time：失效时间
    均为必需项
    ```

    返回：

    -   状态码

        ```
        400：参数不对
        410：添加失败
        201：添加成功
        ```

    -   结果

        ```
        status：状态{
        	code：标识码（0表示成功，非0表示失败）
        	msg：具体状态
        }
        result：数据{
        	data：具体数据
        	rows：受影响的行数
        }
        ```

    -   example

        `POST http://localhost:8080/test/egg?latitude=22&longitude=77&type=2&content=url://something2111&color=blue&expire_time=2020-11-01 01:00&uuname=test2222&name=egg11`

        ```json
        {
            "status": {
                "code": 0,
                "msg": "Success"
            },
            "result": {
                "data": [
                    {
                        "id": 1254007430,
                        "name": "egg11",
                        "color": "blue",
                        "type": 2,
                        "latitude": 22.0,
                        "longitude": 77.0,
                        "content": "url://something2111",
                        "expire_time": "2020-11-01 01:00:00.0",
                        "is_deleted": 0
                    }
                ],
                "rows": 1
            }
        }
        ```

3.  修改彩蛋

    url：`/egg`

    方法：PUT

    参数：

    ```
    uuname：当前操作的用户名（必需）
    id：彩蛋id
    name：彩蛋名称
    color：彩蛋颜色（可以传个RGB16进制的那种）
    type：彩蛋类型（1：文字，2：语音，3：图片，4：视频）
    latitude：纬度
    longitude：精度
    content：彩蛋内容
    expire_time：失效时间
    is_deleted：是否已删除
    uuname为必需，id或name必需
    ```

    返回：

    -   状态码

        ```
        400：参数不对
        410：修改失败
        201：修改成功
        ```

    -   结果

        ```
        status：状态{
        	code：标识码（0表示成功，非0表示失败）
        	msg：具体状态
        }
        result：数据{
        	data：具体数据
        	rows：受影响的行数
        }
        ```

    -   example

        `PUT http://localhost:8080/test/egg?content=something2333&id=1254007430&uuname=test2222`

        ```json
        {
            "status": {
                "code": 0,
                "msg": "Success"
            },
            "result": {
                "data": [
                    {
                        "id": 1254007430,
                        "name": "egg11",
                        "color": "blue",
                        "type": 2,
                        "latitude": 22.0,
                        "longitude": 77.0,
                        "content": "something2333",
                        "expire_time": "2020-11-01 01:00:00.0",
                        "is_deleted": 0
                    }
                ],
                "rows": 1
            }
        }
        ```

4.  删除彩蛋

    url：`/egg`

    方法：DELETE

    参数：

    ```
    uuname：当前操作的用户名
    id：彩蛋id
    name：彩蛋名称
    uuname为必需，id或name必需
    ```

    返回：

    -   状态码

        ```
        400：参数不对
        410：删除失败
        201：删除成功
        ```

    -   结果

        ```
        status：状态{
        	code：标识码（0表示成功，非0表示失败）
        	msg：具体状态
        }
        result：数据{
        	data：具体数据
        	rows：受影响的行数
        }
        ```

    -   example

        `DELETE http://localhost:8080/test/egg?id=1254007430&uuname=test2222`

        ```json
        {
            "status": {
                "code": 0,
                "msg": "Success"
            },
            "result": {
                "data": [
                    {
                        "id": 1254007430,
                        "name": "egg11",
                        "color": "blue",
                        "type": 2,
                        "latitude": 22.0,
                        "longitude": 77.0,
                        "content": "something2333",
                        "expire_time": "2020-11-01 01:00:00.0",
                        "is_deleted": 0
                    }
                ],
                "rows": 1
            }
        }
        ```

## 行为相关

行为指挖彩蛋、埋彩蛋的动作

1.  查询行为

    url：`/action`

    方法：GET

    参数：

    ```
    uuname：当前操作的用户名（必需）
    id：行为id
    user_id：用户id
    egg_id：彩蛋id
    action：行为（1：埋彩蛋，2：挖彩蛋）
    user_username：用户名
    user_nickname：用户昵称
    egg_name：彩蛋名称
    除必需外其余参数均可选
    ```

    返回：

    -   状态码

        ```
        400：参数不对
        410：没查到
        200：查询成功
        ```

    -   结果

        ```
        status：状态{
        	code：标识码（0表示成功，非0表示失败）
        	msg：具体状态
        }
        result：数据{
        	data：具体数据
        	rows：受影响的行数
        }
        ```

    -   example

        `GET http://localhost:8080/test/action?user_id=687005410&uuname=test2222`

        ```json
        {
            "status": {
                "code": 0,
                "msg": "Success"
            },
            "result": {
                "data": [
                    {
                        "id": 407058930,
                        "user": {（对应的用户信息）
                            "id": 687005410,
                            "username": "test2",
                            "gender": "M",
                            "nickname": "abcdefg",
                            "contact": "13801111100",
                            "is_online": 0,
                            "latitude": 14.0,
                            "longitude": 66.0,
                            "set_count": 1,
                            "get_count": 1,
                            "is_deleted": 0
                        },
                        "egg": {（对应的彩蛋信息）
                            "id": 1942732372,
                            "name": "egg11",
                            "color": "blue",
                            "type": 2,
                            "latitude": 21.0000001,
                            "longitude": 55.0,
                            "content": "url://something2111",
                            "expire_time": "2021-01-01 00:00:00.0",
                            "is_deleted": 0
                        },
                        "action": 1,（行为）
                        "is_deleted": 0,
                        "update_time": "2020-10-25 17:41:57.0"
                    },
                    {
                        "id": 724014183,
                        "user": {
                            "id": 687005410,
                            "username": "test2",
                            "gender": "M",
                            "nickname": "abcdefg",
                            "contact": "13801111100",
                            "is_online": 0,
                            "latitude": 14.0,
                            "longitude": 66.0,
                            "set_count": 1,
                            "get_count": 1,
                            "is_deleted": 0
                        },
                        "egg": {
                            "id": 2076294926,
                            "name": "egg15",
                            "color": "yellow",
                            "type": 3,
                            "latitude": 21.0,
                            "longitude": 66.0,
                            "content": "url://something2333",
                            "expire_time": "2020-11-01 01:00:00.0",
                            "is_deleted": 0
                        },
                        "action": 2,
                        "is_deleted": 0,
                        "update_time": "2020-10-26 15:29:12.0"
                    }
                ],
                "rows": 2
            }
        }
        ```

2.  添加行为

    url：`/action`

    方法：POST

    参数：

    ```
    uuname：当前操作的用户名（必需）
    user_id：用户id
    egg_id：彩蛋id
    action：行为（1：埋彩蛋，2：挖彩蛋）
    均为必需项
    ```

    返回：

    -   状态码

        ```
        400：参数不对
        410：添加失败
        201：添加成功
        ```

    -   结果

        ```
        status：状态{
        	code：标识码（0表示成功，非0表示失败）
        	msg：具体状态
        }
        result：数据{
        	data：具体数据
        	rows：受影响的行数
        }
        ```

    -   example

        `POST http://localhost:8080/test/action?egg_id=2076294926&action=2&uuname=test2222&user_id=1325542530`

        ```json
        {
            "status": {
                "code": 0,
                "msg": "Success"
            },
            "result": {
                "data": [
                    {
                        "id": 1183662930,
                        "user": {
                            "id": 1325542530,
                            "username": "test3",
                            "gender": "M",
                            "nickname": "abcdefg",
                            "contact": "13801111100",
                            "is_online": 0,
                            "latitude": 21.0,
                            "longitude": 55.0,
                            "set_count": 0,
                            "get_count": 3,
                            "is_deleted": 0
                        },
                        "egg": {
                            "id": 2076294926,
                            "name": "egg15",
                            "color": "yellow",
                            "type": 3,
                            "latitude": 21.0,
                            "longitude": 66.0,
                            "content": "url://something2333",
                            "expire_time": "2020-11-01 01:00:00.0",
                            "is_deleted": 0
                        },
                        "action": 2,
                        "is_deleted": 0,
                        "update_time": "2020-10-28 17:58:55.0"
                    }
                ],
                "rows": 1
            }
        }
        ```

3.  修改行为

    url：`/action`

    方法：PUT

    参数：

    ```
    uuname：当前操作的用户名（必需）
    id：行为id
    user_id：用户id
    egg_id：彩蛋id
    action：行为（1：埋彩蛋，2：挖彩蛋）
    is_deleted：是否已删除
    uuname为必需，id或name必需
    ```

    返回：

    -   状态码

        ```
        400：参数不对
        410：修改失败
        201：修改成功
        ```

    -   结果

        ```
        status：状态{
        	code：标识码（0表示成功，非0表示失败）
        	msg：具体状态
        }
        result：数据{
        	data：具体数据
        	rows：受影响的行数
        }
        ```

    -   example

        `PUT http://localhost:8080/test/action?id=1183662930&uuname=test2222&is_deleted=1`

        ```json
        {
            "status": {
                "code": 0,
                "msg": "Success"
            },
            "result": {
                "data": [
                    {
                        "id": 1183662930,
                        "user": {
                            "id": 1325542530,
                            "username": "test3",
                            "gender": "M",
                            "nickname": "abcdefg",
                            "contact": "13801111100",
                            "is_online": 0,
                            "latitude": 21.0,
                            "longitude": 55.0,
                            "set_count": 0,
                            "get_count": 3,
                            "is_deleted": 0
                        },
                        "egg": {
                            "id": 2076294926,
                            "name": "egg15",
                            "color": "yellow",
                            "type": 3,
                            "latitude": 21.0,
                            "longitude": 66.0,
                            "content": "url://something2333",
                            "expire_time": "2020-11-01 01:00:00.0",
                            "is_deleted": 0
                        },
                        "action": 2,
                        "is_deleted": 1,
                        "update_time": "2020-10-28 18:02:00.0"
                    }
                ],
                "rows": 1
            }
        }
        ```

4.  删除行为

    url：`/action`

    方法：DELETE

    参数：

    ```
    uuname：当前操作的用户名
    id：行为id
    user_id：用户id
    egg_id：彩蛋id
    action：行为（1：埋彩蛋，2：挖彩蛋）
    uuname为必需，id或其余三个必需
    ```

    返回：

    -   状态码

        ```
        400：参数不对
        410：删除失败
        201：删除成功
        ```

    -   结果

        ```
        status：状态{
        	code：标识码（0表示成功，非0表示失败）
        	msg：具体状态
        }
        result：数据{
        	data：具体数据
        	rows：受影响的行数
        }
        ```

    -   example

        `DELETE http://localhost:8080/test/action?id=1183662930&uuname=test2222`

        ```json
        {
            "status": {
                "code": 0,
                "msg": "Success"
            },
            "result": {
                "data": [
                    {
                        "id": 1183662930,
                        "user": {
                            "id": 1325542530,
                            "username": "test3",
                            "gender": "M",
                            "nickname": "abcdefg",
                            "contact": "13801111100",
                            "is_online": 0,
                            "latitude": 21.0,
                            "longitude": 55.0,
                            "set_count": 0,
                            "get_count": 3,
                            "is_deleted": 0
                        },
                        "egg": {
                            "id": 2076294926,
                            "name": "egg15",
                            "color": "yellow",
                            "type": 3,
                            "latitude": 21.0,
                            "longitude": 66.0,
                            "content": "url://something2333",
                            "expire_time": "2020-11-01 01:00:00.0",
                            "is_deleted": 0
                        },
                        "action": 2,
                        "is_deleted": 1,
                        "update_time": "2020-10-28 18:02:00.0"
                    }
                ],
                "rows": 1
            }
        }
        ```

## 其它

1.  获取附近的用户

    url：`/nearuser`

    方法：GET

    参数：

    ```
    uuname：当前操作的用户名
    id：用户id
    username：用户名
    nickname：用户昵称
    uuname为必需，其余三个任选其一
    ```

    返回：

    -   状态码

        ```
        400：参数不对
        410：没查到
        200：查询成功
        ```

    -   结果

        ```
        status：状态{
        	code：标识码（0表示成功，非0表示失败）
        	msg：具体状态
        }
        result：数据{
        	data：具体数据
        	rows：受影响的行数
        }
        ```

    -   example

        `GET http://localhost:8080/test/nearuser?id=1183662930&uuname=test2222`

        ```json
        {
            "status": {
                "code": 0,
                "msg": "Success"
            },
            "result": {
                "data": [
                    {
                        "id": 1814538945,
                        "username": "abc",
                        "gender": "M",
                        "nickname": "abcdefg",
                        "contact": "13801111100",
                        "is_online": 0,
                        "latitude": 22.0,
                        "longitude": 77.0,
                        "set_count": 0,（埋彩蛋数量）
                        "get_count": 0,（挖彩蛋数量）
                        "is_deleted": 0（是否已删除）
                    }
                ],
                "rows": 1
            }
        }
        ```

2.  获取附近的彩蛋

    url：`/nearegg`

    方法：GET

    参数：

    ```
    uuname：当前操作的用户名
    id：用户id
    username：用户名
    nickname：用户昵称
    uuname为必需，其余三个任选其一
    ```

    返回：

    -   状态码

        ```
        400：参数不对
        410：没查到
        200：查询成功
        ```

    -   结果

        ```
        status：状态{
        	code：标识码（0表示成功，非0表示失败）
        	msg：具体状态
        }
        result：数据{
        	data：具体数据
        	rows：受影响的行数
        }
        ```

    -   example

        `GET http://localhost:8080/test/nearegg?id=1183662930&uuname=test2222`

        ```json
        {
            "status": {
                "code": 0,
                "msg": "Success"
            },
            "result": {
                "data": [
                    {
                        "id": 1942732372,
                        "name": "egg11",
                        "color": "blue",
                        "type": 2,
                        "latitude": 21.0000001,
                        "longitude": 55.0,
                        "content": "url://something2111",
                        "expire_time": "2021-01-01 00:00:00.0",
                        "is_deleted": 0
                    },
                    {
                        "id": 2076294926,
                        "name": "egg15",
                        "color": "yellow",
                        "type": 3,
                        "latitude": 21.0,
                        "longitude": 66.0,
                        "content": "url://something2333",
                        "expire_time": "2020-11-01 01:00:00.0",
                        "is_deleted": 0
                    }
                ],
                "rows": 2
            }
        }
        ```
    
3.  上传/下载资源文件

    url：`/file`

    -   上传

        方法：POST

        参数：`file:文件`

        前端可以这样提交：

        ```html
        <form action="/file" enctype="multipart/form-data" method="post">
            Upload：<input type="file" name="file"><br/>
            <input type="submit" value="Submit">
        </form>
        ```

        注意：`enctype="multipart/form-data"`为必需项

        状态码：

        ```
        201：文件上传成功
        400：文件有问题
        500：文件上传失败
        ```

        结果：

        ```
        status：状态{
        	code：标识码（0表示成功，非0表示失败）
        	msg：具体状态
        }
        result：数据{
        	name：文件名
        	value：保留字，可忽略
        	type：类型，默认为file（可忽略）
        }
        ```

        example：

        ```json
        {
            "result":[
                {
                    "name":"id.png",
                    "value":"",
                    "type":"file"
                }
            ],
            "status":{
                "code":0,
                "msg":"Success"
            }
        }
        ```

    -   下载

        方法：GET

        参数：`filename:文件名`

        结果：文件下载

        状态码：

        ```
        200：下载成功
        404：文件不存在
        400：参数不对
        500：文件下载失败
        ```

        


<hr/>

注意：

1.  对于多媒体文件的处理

    可在数据库表中content字段写入文件名（uri），然后上传至服务器；

    请求资源时可从content字段查询到文件名，然后从服务器下载

2.  文件的重名问题

    前端请做好文件的命名处理，后端不支持上传同名文件，会直接拒绝（400）

3.  数据库中保留字段

    create_time：创建时间，如用户创建时间、彩蛋创建时间等

    update_time：更新时间，最后一次更改该数据的时间

    version：版本号，第一次创建时为1，每更改一次就+1

    is_deleted：是否已删除，作为伪删除保留字段，前面提到的各类删除操作为真删除！






